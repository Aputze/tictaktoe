* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --bg-gradient-start: #6B73FF;
    --bg-gradient-end: #000DFF;
    --surface: rgba(255, 255, 255, 0.97);
    --text-strong: #2d3748;
    --text-muted: #4a5568;
    --primary: #6B73FF;
    --primary-strong: #000DFF;
    --x-color: #FF6B6B;
    --o-color: #4ECDC4;
    --success: #2ecc71;
    --border-glass: rgba(255, 255, 255, 0.2);
}

body.dark {
    --bg-gradient-start: #0f2027;
    --bg-gradient-end: #203a43;
    --surface: rgba(24, 27, 38, 0.88);
    --text-strong: #f7fafc;
    --text-muted: #a0aec0;
    --primary: #7F5AF0;
    --primary-strong: #2CB67D;
    --x-color: #EF476F;
    --o-color: #06D6A0;
    --success: #2CB67D;
    --border-glass: rgba(255, 255, 255, 0.12);
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-strong);
    position: relative;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 20% 80%, rgba(107, 115, 255, 0.4) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(0, 13, 255, 0.2) 0%, transparent 50%);
    pointer-events: none;
    z-index: -1;
}

.container {
    background: var(--surface);
    backdrop-filter: blur(30px);
    border-radius: 32px;
    padding: 3rem;
    box-shadow: 
        0 32px 64px rgba(0, 0, 0, 0.25),
        0 0 0 1px rgba(255, 255, 255, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    text-align: center;
    max-width: 560px;
    width: 100%;
    margin: 1rem;
    position: relative;
    animation: slideInUp 0.8s ease-out;
    border: 1px solid var(--border-glass);
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

header h1 {
    font-size: 3.2rem;
    font-weight: 800;
    margin-bottom: 2.5rem;
    background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    letter-spacing: -0.03em;
    position: relative;
}

.options-bar {
    display: flex;
    gap: 1rem;
    align-items: flex-end;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.segmented { display: inline-flex; background: rgba(255,255,255,0.7); border: 1px solid var(--border-glass); border-radius: 12px; padding: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
.segmented.small { padding: 3px; border-radius: 10px; }
.seg-btn { appearance: none; border: none; background: transparent; color: var(--text-strong); padding: 8px 12px; border-radius: 10px; font-weight: 700; cursor: pointer; transition: all 0.2s ease; }
.seg-btn[aria-pressed="true"], .seg-btn.active { background: linear-gradient(135deg, var(--primary), var(--primary-strong)); color: #fff; box-shadow: 0 8px 20px rgba(107,115,255,0.35); }
.seg-btn:hover { transform: translateY(-1px); }

.ai-controls { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
.field { display: grid; gap: 6px; }
.field-label { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; }
.select { appearance: none; padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border-glass); background: rgba(255,255,255,0.9); font-weight: 600; color: var(--text-strong); min-width: 160px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
.select:disabled { opacity: 0.6; cursor: not-allowed; }

.topbar-actions {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.icon-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, rgba(255,255,255,0.98), rgba(255,255,255,0.9));
    cursor: pointer;
    display: grid;
    place-items: center;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.icon-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(0,0,0,0.18); }

.icon-sun, .icon-moon { width: 20px; height: 20px; position: relative; display: block; }
.icon-sun { background: radial-gradient(circle, #ffdd57 35%, transparent 36%), radial-gradient(circle at 50% 0%, #ffdd57 12%, transparent 13%), radial-gradient(circle at 50% 100%, #ffdd57 12%, transparent 13%), radial-gradient(circle at 0% 50%, #ffdd57 12%, transparent 13%), radial-gradient(circle at 100% 50%, #ffdd57 12%, transparent 13%); border-radius: 50%; }
.icon-moon { border-radius: 50%; box-shadow: inset 8px -8px 0 0 #c4c7f5; background: transparent; }



.score-board {
    display: flex;
    justify-content: space-around;
    margin-bottom: 2.5rem;
    gap: 1.5rem;
}

.score-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1.8rem 1.5rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.92), rgba(255, 255, 255, 0.85));
    border-radius: 20px;
    min-width: 130px;
    box-shadow: 
        0 12px 32px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(255, 255, 255, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    backdrop-filter: blur(15px);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    border: 1px solid var(--border-glass);
}

.score-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    transition: left 0.5s ease;
}

.score-item:hover::before {
    left: 100%;
}

.score-item:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.2),
        0 0 0 1px rgba(255, 255, 255, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

.player-label {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
    letter-spacing: 0.02em;
}

.score {
    font-size: 1.8rem;
    font-weight: 800;
    color: #2d3748;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.game-status {
    margin-bottom: 3rem;
    padding: 1.8rem 2rem;
    background: linear-gradient(135deg, rgba(107, 115, 255, 0.12), rgba(0, 13, 255, 0.08));
    border-radius: 20px;
    border: 2px solid rgba(107, 115, 255, 0.25);
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 12px 32px rgba(107, 115, 255, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(10px);
}

.game-status::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #6B73FF, #000DFF, #6B73FF);
    animation: statusGlow 3s ease-in-out infinite;
    border-radius: 20px 20px 0 0;
}

@keyframes statusGlow {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

#status-text {
    font-size: 1.35rem;
    font-weight: 700;
    color: var(--text-strong);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    letter-spacing: 0.01em;
}

.game-board {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0;
    margin-bottom: 3rem;
    max-width: 360px;
    margin-left: auto;
    margin-right: auto;
    padding: 24px;
    position: relative;
    background:
      radial-gradient(circle at 10% 15%, rgba(0,0,0,0.02), transparent 30%),
      radial-gradient(circle at 90% 85%, rgba(0,0,0,0.02), transparent 30%),
      linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0.2))
      ,#f4efe7; /* fabric base */
    border-radius: 12px;
    box-shadow: inset 0 0 30px rgba(0,0,0,0.15), 0 22px 50px rgba(0,0,0,0.25);
    border: 1px solid rgba(0,0,0,0.05);
    overflow: hidden;
}

.game-board::after {
    content: '';
    position: absolute;
    inset: 24px;
    background:
      linear-gradient(to right,
        transparent 0%, transparent 31.5%, rgba(0,0,0,0.7) 31.5%, rgba(0,0,0,0.7) 34.5%, transparent 34.5%,
        transparent 65.5%, rgba(0,0,0,0.7) 65.5%, rgba(0,0,0,0.7) 68.5%, transparent 68.5%),
      linear-gradient(to bottom,
        transparent 0%, transparent 31.5%, rgba(0,0,0,0.7) 31.5%, rgba(0,0,0,0.7) 34.5%, transparent 34.5%,
        transparent 65.5%, rgba(0,0,0,0.7) 65.5%, rgba(0,0,0,0.7) 68.5%, transparent 68.5%);
    filter: blur(0.3px);
    pointer-events: none;
}

.board-frame {
    display: grid;
    place-items: center;
    padding: 22px;
    background: linear-gradient(90deg, #6b4e2e, #915f2a 35%, #6b4e2e 70%, #5a3f25);
    border-radius: 18px;
    box-shadow: inset 0 3px 0 rgba(255,255,255,0.25), inset 0 -3px 0 rgba(0,0,0,0.25), 0 18px 40px rgba(0,0,0,0.35);
    margin-bottom: 2rem;
}

.cell {
    width: 104px;
    height: 104px;
    background: transparent;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0; /* hide text if any */
    cursor: pointer;
    position: relative;
}

.cell::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(107, 115, 255, 0.15), rgba(0, 13, 255, 0.1));
    opacity: 0;
    transition: opacity 0.3s ease;
    border-radius: 16px;
}

.cell:hover::before {
    opacity: 1;
}

.cell:hover { transform: translateY(-2px); }

/* Stone pieces */
.piece {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 84px;
    height: 84px;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    box-shadow: 0 10px 18px rgba(0,0,0,0.35), inset 0 2px 0 rgba(255,255,255,0.2);
}

.piece.tone-light { background: radial-gradient(circle at 30% 25%, #ffffff 0%, #e4e1db 55%, #cfc9bf 100%); }
.piece.tone-dark { background: radial-gradient(circle at 30% 25%, #6a6a6a 0%, #4b4b4b 55%, #3b3b3b 100%); }

.piece::after { content: ''; position: absolute; inset: 14px; background-size: contain; background-repeat: no-repeat; background-position: center; filter: drop-shadow(0 2px 0 rgba(0,0,0,0.15)); }
.piece-heart::after { background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50 84 C50 84 16 64 16 40 C16 28 26 20 38 20 C44 20 48 22 50 26 C52 22 56 20 62 20 C74 20 84 28 84 40 C84 64 50 84 50 84 Z' fill='%23ff4f9a' stroke='%23ff0f6a' stroke-width='6' stroke-linecap='round' stroke-linejoin='round'/></svg>"); }
.piece-x::after { background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M25 25 L75 75 M75 25 L25 75' stroke='%2369e64a' stroke-width='14' stroke-linecap='round' /></svg>"); }

/* Slightly irregular pebble silhouettes */
.piece.variant-1 { clip-path: ellipse(50% 46% at 50% 50%); }
.piece.variant-2 { clip-path: ellipse(46% 50% at 52% 48%); }
.piece.variant-3 { clip-path: ellipse(48% 44% at 50% 52%); }
.piece.variant-4 { clip-path: ellipse(45% 49% at 49% 50%); }
.piece.variant-5 { clip-path: ellipse(47% 47% at 51% 49%); }

.cell.winning .piece { box-shadow: 0 0 0 3px rgba(255,255,255,0.8), 0 12px 22px rgba(0,0,0,0.45); }

.cell.winning {
    background: linear-gradient(135deg, rgba(46, 204, 113, 0.3), rgba(46, 204, 113, 0.1));
    border-color: #2ecc71;
    border-width: 3px;
    animation: winner 0.8s ease-in-out infinite alternate;
    box-shadow: 
        0 0 20px rgba(46, 204, 113, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transform: scale(1.05);
}

@keyframes popIn {
    0% {
        transform: scale(0.3) rotate(-180deg);
        opacity: 0;
    }
    50% {
        transform: scale(1.1) rotate(10deg);
    }
    100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
}

@keyframes winner {
    0% {
        box-shadow: 0 0 20px rgba(46, 204, 113, 0.4), 0 0 40px rgba(46, 204, 113, 0.2);
        transform: scale(1.05);
    }
    100% {
        box-shadow: 0 0 30px rgba(46, 204, 113, 0.8), 0 0 60px rgba(46, 204, 113, 0.4);
        transform: scale(1.08);
    }
}

.controls {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 1rem;
}

.btn {
    padding: 1rem 2rem;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    min-width: 140px;
    position: relative;
    overflow: hidden;
    text-transform: none;
    letter-spacing: 0.02em;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.btn:hover::before {
    left: 100%;
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary), var(--primary-strong));
    color: white;
    box-shadow: 
        0 12px 32px rgba(107, 115, 255, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.15);
}

.btn-primary:hover {
    transform: translateY(-6px) scale(1.08);
    box-shadow: 
        0 20px 50px rgba(107, 115, 255, 0.5),
        0 0 0 1px rgba(255, 255, 255, 0.25);
}

.btn-secondary {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
    color: var(--primary);
    border: 2px solid rgba(107, 115, 255, 0.4);
    box-shadow: 
        0 12px 32px rgba(0, 0, 0, 0.12),
        0 0 0 1px rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(10px);
}

.btn-secondary:hover {
    background: linear-gradient(135deg, rgba(107, 115, 255, 0.15), rgba(0, 13, 255, 0.1));
    border-color: rgba(107, 115, 255, 0.8);
    transform: translateY(-6px) scale(1.08);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.2),
        0 0 0 1px rgba(107, 115, 255, 0.3);
}

.winning-line {
    position: absolute;
    background: linear-gradient(90deg, #e8f5e9, #c8e6c9);
    border-radius: 6px;
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 10;
    box-shadow: 0 0 2px rgba(0,0,0,0.35), 0 10px 24px rgba(0,0,0,0.25);
    animation: winningLineGlow 2s ease-in-out infinite alternate;
}

@keyframes winningLineGlow {
    0% {
        box-shadow: 
            0 0 20px rgba(46, 204, 113, 0.6),
            0 0 40px rgba(46, 204, 113, 0.3),
            inset 0 0 0 1px rgba(255, 255, 255, 0.3);
    }
    100% {
        box-shadow: 
            0 0 30px rgba(46, 204, 113, 0.8),
            0 0 60px rgba(46, 204, 113, 0.4),
            inset 0 0 0 1px rgba(255, 255, 255, 0.5);
    }
}

.winning-line.show {
    opacity: 1;
}

.winning-line.horizontal {
    height: 8px;
    width: 306px;
    border-radius: 3px;
}

.winning-line.vertical {
    width: 8px;
    height: 306px;
    border-radius: 3px;
}

.winning-line.diagonal {
    width: 8px;
    height: 433px;
    border-radius: 3px;
}

.winning-line.diagonal-reverse {
    width: 8px;
    height: 433px;
    border-radius: 3px;
}

@media (max-width: 600px) {
    .container {
        padding: 2rem;
        margin: 0.5rem;
        max-width: 95%;
        border-radius: 24px;
    }
    .options-bar { flex-direction: column; align-items: stretch; gap: 0.75rem; }
    .ai-controls { justify-content: space-between; }
    
    header h1 {
        font-size: 2.4rem;
        margin-bottom: 2rem;
    }
    
    .cell {
        width: 75px;
        height: 75px;
        font-size: 2.2rem;
        border-radius: 16px;
    }
    
    .score-board {
        flex-direction: column;
        align-items: center;
        gap: 1.2rem;
    }
    
    .score-item {
        min-width: 110px;
        padding: 1.5rem;
    }
    
    .controls {
        flex-direction: column;
        align-items: center;
        gap: 1.2rem;
    }
    
    .btn {
        width: 100%;
        max-width: 220px;
        padding: 1.2rem 2rem;
    }
    
    .game-board {
        padding: 20px;
        gap: 15px;
        max-width: 300px;
    }
    
    .game-status {
        padding: 1.5rem;
        margin-bottom: 2.5rem;
    }
}

/* Add some floating particles for extra visual appeal */
.container::after {
    content: '';
    position: absolute;
    top: -50px;
    right: -50px;
    width: 100px;
    height: 100px;
    background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
    border-radius: 50%;
    animation: float 6s ease-in-out infinite;
    pointer-events: none;
}

/* Overlay (end of game) */
.overlay {
    position: fixed;
    inset: 0;
    display: grid;
    place-items: center;
    background: rgba(0,0,0,0.35);
    backdrop-filter: blur(2px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.overlay.show { opacity: 1; pointer-events: auto; }

.overlay-card {
    background: var(--surface);
    border-radius: 20px;
    padding: 2rem;
    min-width: 280px;
    box-shadow: 0 16px 40px rgba(0,0,0,0.25), 0 0 0 1px var(--border-glass);
    text-align: center;
}

.overlay-status {
    font-size: 1.5rem;
    font-weight: 800;
    margin-bottom: 1.25rem;
    color: var(--text-strong);
}

.overlay-actions { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }

/* Focus states for accessibility */
.btn:focus, .cell:focus, .icon-btn:focus { outline: none; box-shadow: 0 0 0 3px rgba(127,90,240,0.45), 0 0 0 1px rgba(255,255,255,0.6) inset; }

.container::before {
    content: '';
    position: absolute;
    bottom: -30px;
    left: -30px;
    width: 60px;
    height: 60px;
    background: radial-gradient(circle, rgba(118, 75, 162, 0.1) 0%, transparent 70%);
    border-radius: 50%;
    animation: float 8s ease-in-out infinite reverse;
    pointer-events: none;
}

@keyframes float {
    0%, 100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.5;
    }
    50% {
        transform: translateY(-20px) rotate(180deg);
        opacity: 0.8;
    }
}
